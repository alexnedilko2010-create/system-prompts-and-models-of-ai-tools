# üîí –ó–∞–∫—Ä—ã—Ç–∏–µ Flash Loan –ø—Ä–∏ Self-Sandwich —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

## ‚ö° –ö–ª—é—á–µ–≤–æ–π –≤–æ–ø—Ä–æ—Å: –û—Ç–∫—É–¥–∞ SOL –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ FL?

### üìä –ú–µ—Ö–∞–Ω–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è Flash Loan

```python
flash_loan_lifecycle = {
    'borrow': 300,  # SOL
    'must_return': 301.5,  # SOL + 0.5% fee
    
    'question': '–ï—Å–ª–∏ –º—ã –ø–æ–∫—É–ø–∞–µ–º —Ç–æ–∫–µ–Ω—ã, –æ—Ç–∫—É–¥–∞ SOL –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞?',
    'answer': '–ò–∑ –ü–†–û–î–ê–ñ–ò —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏!'
}
```

## üéØ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª Self-Sandwich —Å FL

### –®–∞–≥ 1: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏

```javascript
const atomicTransaction = {
    // 1. –ë–µ—Ä–µ–º Flash Loan
    flashLoanBorrow: {
        amount: 300,  // SOL
        fee: 1.5,     // SOL (0.5%)
        mustReturn: 301.5  // SOL
    },
    
    // 2. –ü–æ–∫—É–ø–∞–µ–º + Self-Sandwich
    buyWithSandwich: {
        flBuys: 300,  // SOL —Ç—Ä–∞—Ç–∏–º
        yourSales: {
            wallet2: '–ü—Ä–æ–¥–∞–µ—Ç 50M —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ 50 SOL',
            wallet3: '–ü—Ä–æ–¥–∞–µ—Ç 60M —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ 60 SOL',
            wallet4: '–ü—Ä–æ–¥–∞–µ—Ç 40M —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ 48 SOL'
        },
        totalYourSOL: 158  // SOL –æ—Ç –≤–∞—à–∏—Ö –ø—Ä–æ–¥–∞–∂
    },
    
    // 3. –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–∏–∑–æ—à–ª–∞!
    
    // 4. –ü—Ä–æ–¥–∞–µ–º —á–∞—Å—Ç—å FL —Ç–æ–∫–µ–Ω–æ–≤
    flSellAfterMigration: {
        sellAmount: '40% –∫—É–ø–ª–µ–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤',
        expectedSOL: 180,  // SOL –æ—Ç –ø—Ä–æ–¥–∞–∂–∏
        
        // –í–ê–ñ–ù–û: 158 + 180 = 338 SOL
        // –•–≤–∞—Ç–∞–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 301.5 SOL!
    },
    
    // 5. –í–æ–∑–≤—Ä–∞—â–∞–µ–º Flash Loan
    returnFlashLoan: 301.5  // SOL
};
```

## üí° –ü–æ—á–µ–º—É Self-Sandwich –ù–ï –ª–æ–º–∞–µ—Ç FL?

### –í–∞—Ä–∏–∞–Ω—Ç A: FL –ø–æ–∫—É–ø–∞–µ—Ç –≤–∞—à–∏ —Ç–æ–∫–µ–Ω—ã

```python
def sandwich_scenario_a():
    """FL –ø–æ–∫—É–ø–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø—Ä–æ–¥–∞–µ—Ç–µ"""
    
    # FL –ø–æ—Ç—Ä–∞—Ç–∏–ª 300 SOL –Ω–∞:
    fl_bought = {
        'from_bonding_curve': '60% (180 SOL)',
        'from_your_wallets': '40% (120 SOL)',  # –ö—É–ø–∏–ª –í–ê–®–ò —Ç–æ–∫–µ–Ω—ã!
        'total_tokens': '400M tokens'
    }
    
    # –í—ã –ø–æ–ª—É—á–∏–ª–∏:
    you_received = {
        'from_fl_purchases': 120,  # SOL
        'from_other_buyers': 38,   # SOL (FOMO –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏)
        'total': 158  # SOL
    }
    
    # –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
    post_migration = {
        'fl_sells': '160M tokens –∑–∞ 180 SOL',
        'fl_keeps': '240M tokens',
        'fl_total_sol': 180,  # –û—Ç –ø—Ä–æ–¥–∞–∂–∏
        
        'can_return_loan': True  # 180 SOL —Ö–≤–∞—Ç–∏—Ç!
    }
    
    return "FL –∑–∞–∫—Ä–æ–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ!"
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å

```javascript
const scenarioB = {
    // FL –ø–æ–∫—É–ø–∞–µ—Ç –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
    sources: {
        bondingCurve: '200 SOL worth',
        yourSales: '100 SOL worth',
        
        // –í—ã –ø—Ä–æ–¥–∞–ª–∏ —Ç–æ–∫–µ–Ω—ã –∏ –ø–æ–ª—É—á–∏–ª–∏ SOL
        yourSOL: 100
    },
    
    // –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ FL –º–æ–∂–µ—Ç:
    options: [
        {
            strategy: '–ü—Ä–æ–¥–∞—Ç—å 35%',
            getSOL: 175,
            returnLoan: '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç 126.5 SOL'
        },
        {
            strategy: '–ü—Ä–æ–¥–∞—Ç—å 45%',
            getSOL: 225,
            returnLoan: '–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç 76.5 SOL'
        },
        {
            strategy: '–ü—Ä–æ–¥–∞—Ç—å 60%',
            getSOL: 302,
            returnLoan: '–£—Å–ø–µ—Ö! –û—Å—Ç–∞—Ç–æ–∫ 0.5 SOL'
        }
    ]
};
```

## üîÑ –†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å —Ç–æ—á–Ω—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏

### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
```
MC –¥–æ –æ–ø–µ—Ä–∞—Ü–∏–∏: $75,000
FL —Ä–∞–∑–º–µ—Ä: 300 SOL
–í–∞—à–∞ –ø–æ–∑–∏—Ü–∏—è: 400M —Ç–æ–∫–µ–Ω–æ–≤ (40% supply)
–¶–µ–ª—å: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ $83,000
```

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ:

```python
execution_flow = {
    # T+0: –ù–∞—á–∞–ª–æ
    'initial_state': {
        'token_price': 0.000075,
        'your_tokens': 400_000_000,
        'fl_sol': 300
    },
    
    # T+1: FL –ø–æ–∫—É–ø–∫–∞ —Å sandwich
    'during_execution': {
        'fl_buys_round1': {
            'spends': 100,  # SOL
            'gets': '120M tokens',
            'price_impact': '‚Üí $0.000082'
        },
        
        'your_sell1': {
            'from_wallet2': '50M tokens',
            'get_sol': 41,  # SOL –ø–æ —Ü–µ–Ω–µ 0.000082
            'to_whom': 'FL + –∞—Ä–±–∏—Ç—Ä–∞–∂–µ—Ä—ã'
        },
        
        'fl_buys_round2': {
            'spends': 100,  # SOL
            'gets': '100M tokens',
            'price_impact': '‚Üí $0.000091'
        },
        
        'your_sell2': {
            'from_wallet3': '60M tokens',
            'get_sol': 54.6,  # SOL –ø–æ —Ü–µ–Ω–µ 0.000091
            'to_whom': 'FL + –Ω–æ–≤—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏'
        },
        
        'fl_buys_round3': {
            'spends': 100,  # SOL
            'gets': '80M tokens',
            'price_impact': '‚Üí $0.000100 = MIGRATION!'
        }
    },
    
    # T+2: –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
    'post_migration': {
        'fl_has': '300M tokens',
        'fl_needs': 301.5,  # SOL –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
        
        'fl_sells': {
            'amount': '180M tokens (60%)',
            'at_price': 0.000095,  # –ù–µ–±–æ–ª—å—à–æ–π –¥–∞–º–ø
            'gets_sol': 171  # SOL
        },
        
        'your_sandwich_profit': {
            'sold_tokens': '110M',
            'received_sol': 95.6,
            'avg_price': 0.000087
        },
        
        'problem': 'FL –ø–æ–ª—É—á–∏–ª —Ç–æ–ª—å–∫–æ 171 SOL, –Ω—É–∂–Ω–æ 301.5!'
    }
}
```

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê: FL –º–æ–∂–µ—Ç –Ω–µ –∑–∞–∫—Ä—ã—Ç—å—Å—è!

### –ü–æ—á–µ–º—É FL –º–æ–∂–µ—Ç –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è:

```python
fl_failure_analysis = {
    'fl_spent': 300,  # SOL –Ω–∞ –ø–æ–∫—É–ø–∫—É
    'fl_must_return': 301.5,  # SOL –¥–æ–ª–≥
    
    'fl_tokens': '300M',
    'fl_can_sell': '60-70% max',  # –ë–æ–ª—å—à–µ = –æ–±–≤–∞–ª —Ü–µ–Ω—ã
    'fl_gets_from_sale': '170-200 SOL',
    
    'shortage': '101.5 - 131.5 SOL',
    
    'result': 'FL –ù–ï –ú–û–ñ–ï–¢ –ó–ê–ö–†–´–¢–¨–°–Ø!'
}
```

## ‚úÖ –†–ï–®–ï–ù–ò–ï: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: FL + –í–∞—à–∏ SOL

```javascript
const hybridSolution = {
    setup: {
        yourTokens: '400M (40% supply)',
        yourSOL: 150,  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ SOL
        flashLoan: 200  // –ú–µ–Ω—å—à–∏–π FL!
    },
    
    execution: {
        // –ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º FL + –≤–∞—à–∏ SOL
        totalBuyPower: 350,  // SOL (200 FL + 150 yours)
        
        // Self-sandwich
        yourSales: '100M tokens –∑–∞ 90 SOL',
        
        // FL –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å
        flMustReturn: 201,  // SOL
        
        // FL –ø—Ä–æ–¥–∞–µ—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
        flSells: '40% –ø–æ–∑–∏—Ü–∏–∏ –∑–∞ 120 SOL',
        yourSOLFromSales: 90,  // SOL
        
        // 120 + 90 = 210 SOL > 201 –Ω—É–∂–Ω–æ!
        result: 'FL –ó–ê–ö–†–û–ï–¢–°–Ø –£–°–ü–ï–®–ù–û!'
    }
};
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

```python
def two_stage_strategy():
    """–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–∫–∞—á–∏–≤–∞–µ–º, –ø–æ—Ç–æ–º FL"""
    
    stage1 = {
        'your_action': '–ü–æ–∫—É–ø–∞–µ—Ç–µ —Å–∞–º–∏ 100 SOL',
        'mc_movement': '$75k ‚Üí $78k',
        'your_new_position': '450M tokens'
    }
    
    stage2 = {
        'flash_loan': 150,  # SOL (–º–µ–Ω—å—à–µ!)
        'your_sandwich': '–ü—Ä–æ–¥–∞–µ—Ç–µ 80M –∑–∞ 70 SOL',
        'migration': 'Triggered at $83k',
        
        'fl_sells': '30% –∑–∞ 90 SOL',
        'your_sol': 70,  # –û—Ç sandwich
        'total': 160,  # SOL
        'fl_needs': 150.75,  # SOL
        
        'success': True
    }
```

## üìä –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è Self-Sandwich

```python
optimal_formula = {
    'rule': 'FL —Ä–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–∏–º, —á—Ç–æ–±—ã:',
    
    'calculation': '''
    FL_size * 0.4 (–ø—Ä–æ–¥–∞–∂–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏) +
    Your_sandwich_sales_SOL >= 
    FL_size * 1.005 (–¥–æ–ª–≥ + –∫–æ–º–∏—Å—Å–∏—è)
    ''',
    
    'example': {
        'fl_size': 200,
        'fl_return_need': 201,
        'fl_can_sell_for': 80,  # SOL (40% —Ç–æ–∫–µ–Ω–æ–≤)
        'your_must_sell_for': 121,  # SOL minimum
        'your_tokens_to_sell': '130M @ 0.00093'
    },
    
    'safety_margin': '–î–æ–±–∞–≤—å—Ç–µ 20% –∑–∞–ø–∞—Å!'
}
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### ‚úÖ Self-Sandwich –†–ê–ë–û–¢–ê–ï–¢ –µ—Å–ª–∏:

1. **FL –Ω–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π** (150-250 SOL –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
2. **–í—ã –ø—Ä–æ–¥–∞–µ—Ç–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ** (–ø–æ–ª—É—á–∞–µ—Ç–µ 40%+ –æ—Ç FL —Ä–∞–∑–º–µ—Ä–∞)
3. **–ï—Å—Ç—å –∑–∞–ø–∞—Å–Ω–æ–π –ø–ª–∞–Ω** (–≤–∞—à–∏ SOL –∏–ª–∏ –ø–∞—Ä—Ç–Ω–µ—Ä)
4. **–†–∞—Å—á–µ—Ç —Å –∑–∞–ø–∞—Å–æ–º** (20% –±—É—Ñ–µ—Ä –º–∏–Ω–∏–º—É–º)

### ‚ùå Self-Sandwich –ü–†–û–í–ê–õ–ò–¢–°–Ø –µ—Å–ª–∏:

1. **FL —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π** (300+ SOL)
2. **–ú–∞–ª–æ –ø—Ä–æ–¥–∞–µ—Ç–µ –≤ sandwich** (<30% –æ—Ç FL)
3. **–ù–µ—Ç –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏**
4. **–°–ª–∏—à–∫–æ–º –∂–∞–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è**

## üí° –õ—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞

```python
best_practice = {
    'fl_size': '–ù–µ –±–æ–ª—å—à–µ 70% –æ—Ç –Ω—É–∂–Ω–æ–≥–æ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏',
    'your_position': '–ú–∏–Ω–∏–º—É–º 35% supply',
    'sandwich_sales': '–ü—Ä–æ–¥–∞–≤–∞—Ç—å 25-30% –≤–∞—à–µ–π –ø–æ–∑–∏—Ü–∏–∏',
    'safety': '–ò–º–µ—Ç—å 50-100 SOL —Ä–µ–∑–µ—Ä–≤',
    'execution': '–í—Å–µ –≤ –æ–¥–Ω–æ–π –∞—Ç–æ–º–∞—Ä–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏'
}
```

**–í–´–í–û–î**: Self-Sandwich –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å FL –µ—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω! –í—Å–µ–≥–¥–∞ –º–æ–¥–µ–ª–∏—Ä—É–π—Ç–µ —Å –∑–∞–ø–∞—Å–æ–º.