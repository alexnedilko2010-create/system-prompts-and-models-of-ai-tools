# 📊 Расчет fees за цикл - Простая визуализация

## 🧮 Базовая формула

```
ФОРМУЛА РАСЧЕТА FEES:
═══════════════════════════════════════════

Fees = Volume × Fee% × Your Share × Time

Где:
• Volume = сколько $ торгуется в секунду
• Fee% = комиссия пула (0.05-0.25%)
• Your Share = ваша доля в range
• Time = 0.4 секунды (длительность цикла)
═══════════════════════════════════════════
```

## 📈 Пошаговый расчет

```
ПРИМЕР РАСЧЕТА:
═══════════════════════════════════════════

1️⃣ Узнаем volume пула
   SOL/USDC торгует $500k/секунду

2️⃣ За время нашего цикла (400ms)
   Volume = $500k × 0.4 = $200k

3️⃣ Комиссия пула 0.25%
   Total fees = $200k × 0.25% = $500

4️⃣ Наша доля в concentrated range
   Мы: $1M в range ±0.5%
   Эффект: $1M × 50x = $50M
   Всего в range: $100M
   Наша доля: 50%

5️⃣ Наши fees
   $500 × 50% = $250 ✅

6️⃣ Вычитаем costs
   FL fee: -$100
   Gas: -$5
   NET: +$145 profit!
═══════════════════════════════════════════
```

## 🎯 Как узнать активность пула

```
ГДЕ СМОТРЕТЬ VOLUME:
═══════════════════════════════════════════

1. Дексскринер (dexscreener.com)
   └─ 24h volume ÷ 86,400 = $/sec

2. Прямо из блокчейна
   └─ Последние 100 свопов
   └─ Сумма volume ÷ время

3. Analytics платформы
   └─ Orca/Raydium analytics
   └─ Flipside Crypto

Пример:
24h volume: $43.2M
Per second: $500/sec
═══════════════════════════════════════════
```

## 📊 Быстрая таблица оценки

```
СКОЛЬКО FEES ЗА ЦИКЛ (400ms):
═══════════════════════════════════════════

Volume/sec  Your Share  Fee%    = Your Fees
─────────────────────────────────────────
$100k       × 80%      × 0.05%  = $16 ❌
$300k       × 60%      × 0.25%  = $180 ✅
$500k       × 50%      × 0.25%  = $250 ✅
$1M         × 40%      × 0.25%  = $400 ✅

Нужно чтобы Fees > FL cost ($100)
═══════════════════════════════════════════
```

## 💡 Концентрация = множитель

```
ЭФФЕКТ КОНЦЕНТРАЦИИ:
═══════════════════════════════════════════

Обычная позиция:         Concentrated (±0.5%):
$1M = $1M эффект        $1M = $50M эффект!

В пуле $10M:            В пуле $10M (в range):
Ваша доля: 10%          Ваша доля: 83% 🚀

Fees: $50               Fees: $415
Стоит того!
═══════════════════════════════════════════
```

## 🔍 Реальный пример

```
РАСЧЕТ ДЛЯ USDC/USDT:
═══════════════════════════════════════════

Дано:
• Пул: USDC/USDT 0.05%
• Volume: $300k/sec
• Ваша позиция: $500k
• Range: ±0.02% (очень узкий!)
• Концентрация: 250x

Расчет:
1. Volume за 400ms = $120k
2. Total fees = $120k × 0.05% = $60
3. Ваш эффект = $500k × 250x = $125M
4. В range всего = $150M
5. Ваша доля = 83%
6. Ваши fees = $60 × 83% = $50

Costs: FL $50 + gas $3 = $53
Profit: -$3 (почти breakeven)

Вывод: Нужен больше volume!
═══════════════════════════════════════════
```

## 📈 Оптимальные параметры

```
SWEET SPOTS:
═══════════════════════════════════════════

🟢 Лучшие условия:
• Volume > $500k/sec
• Fee tier: 0.25%
• Your share: 50-70%
• Range: не слишком узкий

🟡 Приемлемые:
• Volume > $300k/sec
• Fee tier: 0.05-0.25%
• Your share: 40%+
• Careful with range

🔴 Избегать:
• Volume < $200k/sec
• Your share < 30%
• Слишком широкий range
═══════════════════════════════════════════
```

## 🚀 Калькулятор профита

```python
# Простой калькулятор
def calculate_profit(
    volume_per_sec,
    fee_percent,
    your_share_percent,
    fl_cost=100
):
    cycle_time = 0.4  # seconds
    
    volume_in_cycle = volume_per_sec * cycle_time
    total_fees = volume_in_cycle * fee_percent
    your_fees = total_fees * your_share_percent
    
    profit = your_fees - fl_cost - 5  # gas
    
    print(f"Volume/cycle: ${volume_in_cycle:,}")
    print(f"Your fees: ${your_fees:.2f}")
    print(f"Profit: ${profit:.2f}")
    
    return profit > 0

# Пример использования
calculate_profit(
    volume_per_sec=500_000,
    fee_percent=0.0025,
    your_share_percent=0.5
)
# Output: Profit: $145.00 ✅
```

## ✅ Простые правила

```
┌────────────────────────────────────┐
│                                    │
│  ПРАВИЛА РАСЧЕТА:                  │
│                                    │
│  1. Volume × 0.4 = volume за цикл  │
│  2. × fee% = total fees            │
│  3. × your share = your fees       │
│  4. - costs = profit               │
│                                    │
│  Минимум для профита:              │
│  Volume > $400k/sec при share 50%  │
│                                    │
│  Концентрация дает 50-200x буст!   │
│                                    │
└────────────────────────────────────┘
```